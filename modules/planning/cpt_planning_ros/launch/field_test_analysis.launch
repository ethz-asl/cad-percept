<!-- killall gzclient -->
<!-- killall gzserver -->

<launch>
  <arg name="show_rviz" default="true" />
  <!-- rope  -->
  <arg name="pulley_free_yaw" default="true"/>
  <arg name="rope_node_num" default="14"/> <!-- have to be even number  -->
  <arg name="rope_node_mass" default="0.0066"/> <!-- rope 66g/m  -->
  <arg name="spring_ks" default="100.0"/>
  <arg name="spring_rest_len" default="0.3"/> <!-- 15cm  -->
  <arg name="pulley_friction" default="0.2"/> <!-- friction between pulley and rope  -->
  <arg name="pulley_radius" default="0.5"/>
  <arg name="update_interval" default="0.1"/>
  <arg name="hooked_node_idx" default="13"/>

<node pkg="tf2_ros" type="static_transform_publisher" name="mesh_broadcaster" args="2.0 1.0 10.2 -0.2705981 0.2705981 0.6532815 0.6532815 enu mesh" />

<node pkg="rope_sim_ros" type="rope_exp_analysis" name="rope_exp_analysis"  output="screen">
    <param name="mesh_frame" type="string" value="mesh" />
    <param name="pulley_free_yaw" value="$(arg pulley_free_yaw)" type="bool"/>
    <param name="rope_node_num" value="$(arg rope_node_num)" type="int"/>
    <param name="rope_node_mass" value="$(arg rope_node_mass)" type="double"/>
    <param name="spring_ks" value="$(arg spring_ks)" type="double"/>
    <param name="spring_rest_len" value="$(arg spring_rest_len)" type="double"/>
    <param name="pulley_friction" value="$(arg pulley_friction)" type="double"/>
    <param name="pulley_radius" value="$(arg pulley_radius)" type="double"/>
    <param name="update_interval" value="$(arg update_interval)" type="double"/>
    <param name="hooked_node_idx" value="$(arg hooked_node_idx)" type="int"/>
    <!-- <param name="mesh_path" type="string" value="/home/liping/Documents/asl_omav_doc/3d-model/test_obs_01.off" /> -->
    <!-- <param name="mesh_path" type="string" value="$(find omav_gazebo_vicon)/models/vicon_wall/meshes/vicon_wall_centered_cut_subsampled_meshLab.off"/> -->
    <!-- <param name="mesh_path" type="string" value="$(find omav_gazebo_vicon)/models/vicon_wall/meshes/vicon_wall_centered_cut_subsampled_thick.off"/> -->
    <param name="mesh_path" type="string" value="$(find omav_gazebo_vicon)/models/vicon_wall/meshes/vicon_wall_large_obstacle_wide.off"/>
    <remap from="rope_exp_analysis/vicon/markers" to="/vicon/markers" />
</node>

<group if="$(arg show_rviz)">
<node type="rviz" name="rviz" pkg="rviz" args="-d $(find rope_sim_ros)/rviz/rope_exp_vis.rviz" />
</group>

</launch>
